{{{
  "title": "Convert Linux machines to use repository installed VMware Tools",
  "date": "1-16-2016",
  "author": "Aaron LeMoine",
  "attachments": [],
  "contentIsHTML": true
}}}

<p>On Linux machines that have had their VMware Tools installed via the tools installer in vSphere, installing distribution or kernel updates can cause the VMware Tools to fail.  The solution to this problem is to remove the vSphere installed version and use a repository based version, which should not be affected by subsequent updates.</p>

<p>“<strong>Detailed Steps</strong>”</p>

<p>We first need to remove the existing vSphere installed version of VMware Tools.  This is done by executing the following script that should exist if the vSphere installed version of VMware Tools is present.</p>
<p>vmware-uninstall-tools.pl</p>
<p>If any other versions of VMware Tools have been installed (including open-vm-tools older than 9.4.0 series), they must be removed. </p>

<p>“<strong>RHEL / CentOS:</strong>”</p>
<p>yum remove vmware*</p>

<p>“<strong>Ubuntu:</strong>”</p>
<p>apt-get remove vmware*</p>
<p>Import the following keys</p>

<p>“<strong>RHEL / CentOS:</strong>”</p>
<p>rpm --import http://packages.vmware.com/tools/keys/VMWARE-PACKAGING-GPG-DSA-KEY.pub</p>
<p>rpm --import http://packages.vmware.com/tools/keys/VMWARE-PACKAGING-GPG-RSA-KEY.pub</p>

<p>“<strong>Ubuntu:</strong>”</p>
<p>wget http://packages.vmware.com/tools/keys/VMWARE-PACKAGING-GPG-DSA-KEY.pub -O - | apt-key add -</p>
<p>wget http://packages.vmware.com/tools/keys/VMWARE-PACKAGING-GPG-RSA-KEY.pub -O - | apt-key add -</p>

<p>“<strong>Create the config file for the new repository:</strong>”</p>

<p>“<strong>RHEL/CentOS 5:</strong>”</p>
<p>echo -e "[vmware-tools]\nname=VMware Tools\nbaseurl=http://packages.vmware.com/tools/releases/latest/rhel5/\$basearch\nenabled=1\ngpgcheck=1" > /etc/yum.repos.d/vmware-tools.repo</p>

<p>“<strong>RHEL/CentOS 6:</strong>”</p>
<p>echo -e "[vmware-tools]\nname=VMware Tools\nbaseurl=http://packages.vmware.com/tools/releases/latest/rhel6/\$basearch\nenabled=1\ngpgcheck=1" > /etc/yum.repos.d/vmware-tools.repo</p>

<p>“<strong>Ubuntu 12.04:</strong>”</p>
<p>echo "deb http://packages.vmware.com/tools/releases/latest/ubuntu precise main" > /etc/apt/sources.list.d/vmware-tools.list</p>

<p>“<strong>Ubuntu 14:04:</strong>”</p>
<p>echo "deb http://packages.vmware.com/packages/ubuntu trusty main" > /etc/apt/sources.list.d/vmware-tools.list</p>

<p>“<strong>Install VMware Tools</strong>”</p>

<p>“<strong>RHEL/CentOS 5 & 6:</strong>”</p>
<p>yum install vmware-tools-esx-kmods vmware-tools-esx-nox</p>
<p>“<strong>RHEL/CentOS 7:</strong>”</p>
<p>yum install open-vm-tools</p>
<p>“<strong>Ubuntu 12.04:</strong>”</p>
<p>apt-get update && apt-get install vmware-tools-esx-kmods-$(uname -r) vmware-tools-esx-nox</p>
<p>“<strong>Ubuntu 14:04:</strong>”</p>
<p>apt-get update && apt-get install open-vm-tools open-vm-tools-deploypkg</p>

<p>Additional Information</p>

<p>If you receive a message that vmware-tools-esx-kmods-<kernel version> doesn't exist, look for the one with the closest kernel version and install it.</p>
<p>aptitude search vmware-tools-esx-kmods</p>
